<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLI-OpenAI Bridge Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: {
                            bg: '#0d1117',
                            card: '#161b22',
                            border: '#30363d',
                            text: '#c9d1d9',
                            muted: '#8b949e'
                        }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="static/dashboard.css">
</head>
<body class="bg-dark-bg text-dark-text min-h-screen">
    <div class="container mx-auto px-4 py-6 max-w-7xl">
        <!-- Header -->
        <div class="flex items-center justify-between mb-6">
            <div>
                <h1 class="text-2xl font-bold text-white">CLI-OpenAI Bridge</h1>
                <p class="text-dark-muted text-sm">Dashboard & Testing Console</p>
            </div>
            <div class="flex items-center gap-4">
                <div id="status-indicator" class="flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-yellow-500"></span>
                    <span class="text-sm text-dark-muted">Connecting...</span>
                </div>
                <button onclick="refreshAll()" class="px-3 py-1.5 bg-dark-card border border-dark-border rounded text-sm hover:bg-dark-border transition">
                    Refresh
                </button>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-dark-card border border-dark-border rounded-lg p-4">
                <div class="text-dark-muted text-sm">Total Requests</div>
                <div id="stat-total" class="text-2xl font-bold text-white">-</div>
            </div>
            <div class="bg-dark-card border border-dark-border rounded-lg p-4">
                <div class="text-dark-muted text-sm">Success Rate</div>
                <div id="stat-success" class="text-2xl font-bold text-green-400">-</div>
            </div>
            <div class="bg-dark-card border border-dark-border rounded-lg p-4">
                <div class="text-dark-muted text-sm">Total Tokens</div>
                <div id="stat-tokens" class="text-2xl font-bold text-blue-400">-</div>
            </div>
            <div class="bg-dark-card border border-dark-border rounded-lg p-4">
                <div class="text-dark-muted text-sm">Uptime</div>
                <div id="stat-uptime" class="text-2xl font-bold text-purple-400">-</div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Left Column: Health & Metrics -->
            <div class="space-y-6">
                <!-- Provider Health -->
                <div class="bg-dark-card border border-dark-border rounded-lg">
                    <div class="px-4 py-3 border-b border-dark-border">
                        <h2 class="font-semibold text-white">Provider Health</h2>
                    </div>
                    <div id="health-status" class="p-4 space-y-3">
                        <div class="text-dark-muted text-sm">Loading...</div>
                    </div>
                </div>

                <!-- Provider Metrics -->
                <div class="bg-dark-card border border-dark-border rounded-lg">
                    <div class="px-4 py-3 border-b border-dark-border flex justify-between items-center">
                        <h2 class="font-semibold text-white">Provider Metrics</h2>
                        <button onclick="resetMetrics()" class="text-xs text-dark-muted hover:text-white transition">Reset</button>
                    </div>
                    <div id="provider-metrics" class="p-4">
                        <div class="text-dark-muted text-sm">Loading...</div>
                    </div>
                </div>

                <!-- Request Log -->
                <div class="bg-dark-card border border-dark-border rounded-lg">
                    <div class="px-4 py-3 border-b border-dark-border flex justify-between items-center">
                        <h2 class="font-semibold text-white">Recent Requests</h2>
                        <button onclick="clearLogs()" class="text-xs text-dark-muted hover:text-white transition">Clear</button>
                    </div>
                    <div id="request-log" class="p-4 h-64 overflow-y-auto scrollbar-thin space-y-2">
                        <div class="text-dark-muted text-sm text-center py-8">No requests yet</div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Testing Console -->
            <div class="bg-dark-card border border-dark-border rounded-lg flex flex-col" style="min-height: 600px;">
                <div class="px-4 py-3 border-b border-dark-border flex justify-between items-center">
                    <div class="flex items-center gap-2">
                        <h2 class="font-semibold text-white">Testing Console</h2>
                        <span id="msg-count" class="text-xs text-dark-muted bg-dark-bg px-2 py-0.5 rounded hidden">0 msgs</span>
                    </div>
                    <button onclick="clearChat()" class="text-xs text-dark-muted hover:text-white transition">Clear Chat</button>
                </div>

                <!-- Model & Settings -->
                <div class="px-4 py-3 border-b border-dark-border space-y-3">
                    <div class="flex gap-3">
                        <div class="flex-1">
                            <label class="text-xs text-dark-muted block mb-1">Model</label>
                            <select id="model-select" class="w-full bg-dark-bg border border-dark-border rounded px-3 py-2 text-sm focus:outline-none focus:border-blue-500">
                                <optgroup label="Claude (aliases)">
                                    <option value="sonnet" selected>sonnet (latest)</option>
                                    <option value="opus">opus (latest)</option>
                                    <option value="haiku">haiku (latest)</option>
                                </optgroup>
                                <optgroup label="Claude 4.5">
                                    <option value="claude-sonnet-4-5-20250929">claude-sonnet-4-5-20250929</option>
                                    <option value="claude-opus-4-5-20251101">claude-opus-4-5-20251101</option>
                                    <option value="claude-haiku-4-5-20251001">claude-haiku-4-5-20251001</option>
                                </optgroup>
                                <optgroup label="Gemini Pro">
                                    <option value="gemini-3-pro-preview">gemini-3-pro-preview</option>
                                    <option value="gemini-2.5-pro">gemini-2.5-pro</option>
                                </optgroup>
                                <optgroup label="Gemini Flash">
                                    <option value="gemini-2.5-flash">gemini-2.5-flash</option>
                                    <option value="gemini-2.5-flash-lite">gemini-2.5-flash-lite</option>
                                    <option value="gemini-2.0-flash">gemini-2.0-flash</option>
                                </optgroup>
                                <optgroup label="GPT-4o">
                                    <option value="gpt-4o">gpt-4o</option>
                                    <option value="gpt-4o-mini">gpt-4o-mini</option>
                                </optgroup>
                                <optgroup label="O1/O3 Reasoning">
                                    <option value="o1">o1</option>
                                    <option value="o1-mini">o1-mini</option>
                                    <option value="o3-mini">o3-mini</option>
                                </optgroup>
                            </select>
                        </div>
                        <div class="w-32">
                            <label class="text-xs text-dark-muted block mb-1">API Key</label>
                            <input type="password" id="api-key" placeholder="Optional" class="w-full bg-dark-bg border border-dark-border rounded px-3 py-2 text-sm focus:outline-none focus:border-blue-500">
                        </div>
                    </div>
                    <div class="flex gap-3 items-center">
                        <label class="flex items-center gap-2 text-sm">
                            <input type="checkbox" id="stream-toggle" checked class="rounded">
                            <span class="text-dark-muted">Stream</span>
                        </label>
                        <label class="text-xs text-dark-muted">System Prompt:</label>
                        <input type="text" id="system-prompt" placeholder="Optional system prompt" class="flex-1 bg-dark-bg border border-dark-border rounded px-3 py-1.5 text-sm focus:outline-none focus:border-blue-500">
                    </div>
                </div>

                <!-- Chat Messages -->
                <div id="chat-messages" class="flex-1 p-4 overflow-y-auto scrollbar-thin space-y-4">
                    <div class="text-center text-dark-muted text-sm py-8">
                        Send a message to start testing
                    </div>
                </div>

                <!-- Input -->
                <div class="p-4 border-t border-dark-border">
                    <div class="flex gap-2">
                        <textarea id="user-input" placeholder="Type your message..." rows="2" class="flex-1 bg-dark-bg border border-dark-border rounded px-3 py-2 text-sm resize-none focus:outline-none focus:border-blue-500"></textarea>
                        <button onclick="sendMessage()" id="send-btn" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded font-medium text-sm transition self-end">
                            Send
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="static/dashboard.js"></script>
</body>
</html>
