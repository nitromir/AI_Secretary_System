# Telegram (–ë–æ—Ç—ã)

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º—É–ª—å—Ç–∏–∏–Ω—Å—Ç–∞–Ω—Å–Ω—ã–º–∏ Telegram –±–æ—Ç–∞–º–∏ —Å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ AI, TTS, –≤–æ—Ä–æ–Ω–∫–æ–π –ø—Ä–æ–¥–∞–∂ –∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏.

## –°–∫—Ä–∏–Ω—à–æ—Ç

<!-- –í—Å—Ç–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã Telegram -->
![Telegram](images/telegram.png)

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–Ω–µ—Å–∫–æ–ª—å–∫–æ Telegram –±–æ—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**. –ö–∞–∂–¥—ã–π –±–æ—Ç:
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ **–æ—Ç–¥–µ–ª—å–Ω—ã–π —Å—É–±–ø—Ä–æ—Ü–µ—Å—Å** Python
- –ò–º–µ–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π LLM –±—ç–∫–µ–Ω–¥, –ø–µ—Ä—Å–æ–Ω—É –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
- –ú–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å–≤–æ—é –≤–æ—Ä–æ–Ω–∫—É –ø—Ä–æ–¥–∞–∂ (–∫–≤–∏–∑, —Å–µ–≥–º–µ–Ω—Ç—ã, –∞–≥–µ–Ω—Ç—Å–∫–∏–µ –ø—Ä–æ–º–ø—Ç—ã)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π** —Å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º AI-–Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–ª–∞—Ç–µ–∂–∏ (Telegram Stars, YooKassa, YooMoney)
- –£–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è (start/stop/restart) –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

## –°–ø–∏—Å–æ–∫ –±–æ—Ç–æ–≤

–õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Å–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã:

| –≠–ª–µ–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä** | –ó–µ–ª—ë–Ω—ã–π = –∑–∞–ø—É—â–µ–Ω, —Å–µ—Ä—ã–π = –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω |
| **–ù–∞–∑–≤–∞–Ω–∏–µ** | –ò–º—è –±–æ—Ç–∞ |
| **Enabled** | –í–∫–ª—é—á—ë–Ω –ª–∏ –±–æ—Ç |
| **–î–µ–π—Å—Ç–≤–∏—è** | Start / Stop / Restart / Delete |

## –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –≤ BotFather

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
3. –í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ username
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω (—Ñ–æ—Ä–º–∞—Ç: `123456:ABC-DEF...`)

### –®–∞–≥ 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Å–∏—Å—Ç–µ–º—É

1. –ù–∞–∂–º–∏—Ç–µ **"–î–æ–±–∞–≤–∏—Ç—å –±–æ—Ç–∞"** –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
2. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Å–º. –Ω–∏–∂–µ)
4. –ù–∞–∂–º–∏—Ç–µ **"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"**

–ò–∑ –Ω–∞–∑–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è slug-ID (–Ω–∞–ø—Ä–∏–º–µ—Ä, `"Sales Bot"` ‚Üí `sales-bot`).

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ –ø–æ –≤–∫–ª–∞–¥–∫–∞–º:

### –û—Å–Ω–æ–≤–Ω—ã–µ (Settings)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **–ù–∞–∑–≤–∞–Ω–∏–µ** | –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è –∏–Ω—Å—Ç–∞–Ω—Å–∞ |
| **–¢–æ–∫–µ–Ω** | Bot API —Ç–æ–∫–µ–Ω (–º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è: `***1234`) |
| **API URL** | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π tunnel/proxy URL –¥–ª—è Telegram API |
| **–û–ø–∏—Å–∞–Ω–∏–µ** | –û–ø–∏—Å–∞–Ω–∏–µ –±–æ—Ç–∞ |
| **Enabled** | –í–∫–ª—é—á–∏—Ç—å/–æ—Ç–∫–ª—é—á–∏—Ç—å –±–æ—Ç |

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (Users)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **Allowed Users** | JSON-–º–∞—Å—Å–∏–≤ Telegram User IDs (–ø—É—Å—Ç–æ–π = –≤—Å–µ –¥–æ–ø—É—â–µ–Ω—ã) |
| **Admin Users** | JSON-–º–∞—Å—Å–∏–≤ User IDs —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –±–æ—Ç–∞ |

### –°–æ–æ–±—â–µ–Ω–∏—è (Messages)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **Welcome** | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ `/start` |
| **Unauthorized** | –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ –≤ –¥–æ—Å—Ç—É–ø–µ |
| **Error** | –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ |
| **Typing** | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ø–µ—á–∞—Ç–∞–µ—Ç..." |

### AI –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **LLM Backend** | `vllm`, `gemini` –∏–ª–∏ `cloud:{provider_id}` |
| **–ü–µ—Ä—Å–æ–Ω–∞** | `anna` –∏–ª–∏ `marina` |
| **System Prompt** | –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç |
| **LLM Params** | JSON —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: `temperature`, `max_tokens`, `top_p` |

### TTS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **Engine** | `xtts`, `piper` –∏–ª–∏ `openvoice` |
| **Voice** | ID –≥–æ–ª–æ—Å–∞ (`anna`, `marina`) |
| **Preset** | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–µ—Å–µ—Ç TTS |

### Rate Limiting

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|--------------|
| **Rate Limit Count** | –ú–∞–∫—Å–∏–º—É–º —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥ | 5 |
| **Rate Limit Hours** | –ü–µ—Ä–∏–æ–¥ –≤ —á–∞—Å–∞—Ö | 5 |

### –°–µ—Å—Å–∏–∏ (Sessions)

- –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–µ—Å—Å–∏–π
- User ID, username, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ö–Ω–æ–ø–∫–∞ **"–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Å—Å–∏–∏"**

### –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π (Buttons)

–ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å **—Ä–µ–∂–∏–º —Ä–∞–∑–≥–æ–≤–æ—Ä–∞** –≤–Ω—É—Ç—Ä–∏ –±–æ—Ç–∞:

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| **Label** | –¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ |
| **Icon** | Emoji-–∏–∫–æ–Ω–∫–∞ |
| **LLM Backend** | –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±—ç–∫–µ–Ω–¥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| **System Prompt** | –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| **LLM Params** | –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| **Order** | –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (drag & drop) |

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É, –±–æ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç ¬´—Ä–µ–∂–∏–º¬ª ‚Äî –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –æ—Ç–≤–µ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–Ω–æ–ø–∫–∏ –≤–º–µ—Å—Ç–æ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö.

### –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ (Sales)

–ú–Ω–æ–≥–æ—Å–µ–∫—Ü–∏–æ–Ω–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–¥–∞–∂:

#### –ö–≤–∏–∑ (Quiz)

–í–æ–ø—Ä–æ—Å—ã —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ—Ç–≤–µ—Ç–∞, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–µ –∫–∞–∫ inline-–∫–Ω–æ–ø–∫–∏:

```json
{
  "question_key": "budget_q1",
  "text": "–ö–∞–∫–æ–π –≤–∞—à –±—é–¥–∂–µ—Ç?",
  "order": 1,
  "options": [
    {"label": "–î–æ 100k", "value": "low", "icon": "üìâ"},
    {"label": "100k-500k", "value": "medium", "icon": "üìä"},
    {"label": "500k+", "value": "high", "icon": "üìà"}
  ]
}
```

#### –°–µ–≥–º–µ–Ω—Ç—ã (Segments)

–ü—Ä–∞–≤–∏–ª–∞ –º–∞—Ç—á–∏–Ω–≥–∞ –ø–æ –æ—Ç–≤–µ—Ç–∞–º –∫–≤–∏–∑–∞ ‚Üí –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞:

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| **Segment Key** | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á |
| **Path** | `diy`, `basic`, `custom`, `qualified`, `unqualified`, `needs_analysis` |
| **Match Rules** | JSON –ø—Ä–∞–≤–∏–ª–∞: `{"budget_q1": "high", "timeline_q2": "immediate"}` |
| **Agent Prompt** | –°—Å—ã–ª–∫–∞ –Ω–∞ –∞–≥–µ–Ω—Ç—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç |

#### –ê–≥–µ–Ω—Ç—Å–∫–∏–µ –ø—Ä–æ–º–ø—Ç—ã (Prompts)

–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
- `system_prompt` ‚Äî –ø—Ä–æ–º–ø—Ç –¥–ª—è LLM
- `temperature`, `max_tokens` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

#### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- **Follow-up –ø—Ä–∞–≤–∏–ª–∞** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ N —á–∞—Å–æ–≤
- **–û—Ç–∑—ã–≤—ã** ‚Äî social proof (—Ç–µ–∫—Å—Ç, –∞–≤—Ç–æ—Ä, —Ä–µ–π—Ç–∏–Ω–≥)
- **A/B —Ç–µ—Å—Ç—ã** ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø—Ä–æ–º–ø—Ç–æ–≤
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** ‚Äî –ø–æ–¥–ø–∏—Å—á–∏–∫–∏, —Å–æ–±—ã—Ç–∏—è –≤–æ—Ä–æ–Ω–∫–∏

### –ü–ª–∞—Ç–µ–∂–∏ (Payments)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **Payment Enabled** | –í–∫–ª—é—á–∏—Ç—å –ø–ª–∞—Ç–µ–∂–∏ |
| **Telegram Stars** | –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ Stars-–ø–ª–∞—Ç–µ–∂–∏ |
| **YooKassa Token** | Provider Token –¥–ª—è YooKassa |
| **Products** | –ú–∞—Å—Å–∏–≤ —Ç–æ–≤–∞—Ä–æ–≤: `title`, `price_rub`, `price_stars` |
| **Success Message** | –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã |

#### YooMoney OAuth2

1. –í–≤–µ–¥–∏—Ç–µ `client_id` –∏ `client_secret`
2. –ù–∞–∂–º–∏—Ç–µ **"–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª—ë–∫"** ‚Üí OAuth-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ popup
3. –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–æ–º–µ—Ä –∫–æ—à–µ–ª—å–∫–∞
4. –ö–Ω–æ–ø–∫–∞ **"–û—Ç–∫–ª—é—á–∏—Ç—å"** –æ—Ç–∑—ã–≤–∞–µ—Ç —Ç–æ–∫–µ–Ω

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º

### –ó–∞–ø—É—Å–∫ / –û—Å—Ç–∞–Ω–æ–≤–∫–∞

| –ö–Ω–æ–ø–∫–∞ | –î–µ–π—Å—Ç–≤–∏–µ | –≠—Ñ—Ñ–µ–∫—Ç –Ω–∞ auto_start |
|--------|----------|---------------------|
| **Start** | –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å—É–±–ø—Ä–æ—Ü–µ—Å—Å | `auto_start = true` |
| **Stop** | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (SIGTERM ‚Üí 5—Å ‚Üí SIGKILL) | `auto_start = false` |
| **Restart** | Stop + Start | –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π |

### Auto-Start

–ë–æ—Ç—ã —Å `auto_start = true` **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è** –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞. –§–ª–∞–≥ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∏ —Å–Ω–∏–º–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ.

### –õ–æ–≥–∏

- –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 100 —Å—Ç—Ä–æ–∫ –ª–æ–≥–∞ –±–æ—Ç–∞
- –õ–æ–≥-—Ñ–∞–π–ª: `logs/telegram_bot_{instance_id}.log`

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—É–±–ø—Ä–æ—Ü–µ—Å—Å–∞

```
POST /admin/telegram/instances/{id}/start
  ‚Üí MultiBotManager.start_bot(id)
    ‚Üí –°–ø–∞–≤–Ω–∏—Ç: python -m telegram_bot
    ‚Üí ENV: BOT_INSTANCE_ID={id}, BOT_INTERNAL_TOKEN={jwt}
    ‚Üí –õ–æ–≥–∏: logs/telegram_bot_{id}.log
```

–í–Ω—É—Ç—Ä–∏ —Å—É–±–ø—Ä–æ—Ü–µ—Å—Å–∞:
1. `TelegramBotService` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥ —á–µ—Ä–µ–∑ API –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
2. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ö–µ–Ω–¥–ª–µ—Ä—ã
3. –ó–∞–ø—É—Å–∫–∞–µ—Ç polling

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç LLM-–∫–æ–Ω—Ñ–∏–≥–∞

–ü—Ä–∏ –æ—Ç–≤–µ—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ–Ω—Ñ–∏–≥ LLM –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É:

1. **Action Button** ‚Äî –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É –¥–µ–π—Å—Ç–≤–∏—è
2. **–°–µ–≥–º–µ–Ω—Ç –≤–æ—Ä–æ–Ω–∫–∏** ‚Äî –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—à—ë–ª –∫–≤–∏–∑ –∏ –ø–æ–ø–∞–ª –≤ —Å–µ–≥–º–µ–Ω—Ç
3. **–î–µ—Ñ–æ–ª—Ç –±–æ—Ç–∞** ‚Äî `system_prompt` + `llm_backend` –∏–Ω—Å—Ç–∞–Ω—Å–∞

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + –∫–≤–∏–∑ (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω) |
| `/help` | –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ |
| `/new` | –°–±—Ä–æ—Å–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç (–Ω–æ–≤–∞—è —Å–µ—Å—Å–∏—è) |
| `/status` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤) |
| `/pay` | –ú–µ–Ω—é —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –æ–ø–ª–∞—Ç—ã |

## –ü–ª–∞—Ç—ë–∂–Ω—ã–µ –ø–æ—Ç–æ–∫–∏

| –ú–µ—Ç–æ–¥ | –í–∞–ª—é—Ç–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|--------|----------|
| **Telegram Stars** | XTR | –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ Telegram |
| **YooKassa** | RUB | Invoice —á–µ—Ä–µ–∑ Telegram Payments API |
| **YooMoney** | RUB | Inline-–∫–Ω–æ–ø–∫–∞ ‚Üí Quickpay URL ‚Üí webhook |

## API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ú—É–ª—å—Ç–∏–∏–Ω—Å—Ç–∞–Ω—Å

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/admin/telegram/instances` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ |
| POST | `/admin/telegram/instances` | –°–æ–∑–¥–∞—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å |
| GET | `/admin/telegram/instances/{id}` | –ö–æ–Ω—Ñ–∏–≥ –∏–Ω—Å—Ç–∞–Ω—Å–∞ |
| PUT | `/admin/telegram/instances/{id}` | –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å |
| DELETE | `/admin/telegram/instances/{id}` | –£–¥–∞–ª–∏—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å |
| POST | `/admin/telegram/instances/{id}/start` | –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ |
| POST | `/admin/telegram/instances/{id}/stop` | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞ |
| POST | `/admin/telegram/instances/{id}/restart` | –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ |
| GET | `/admin/telegram/instances/{id}/status` | –°—Ç–∞—Ç—É—Å + —Å—á—ë—Ç—á–∏–∫ —Å–µ—Å—Å–∏–π |
| GET | `/admin/telegram/instances/{id}/sessions` | –°–ø–∏—Å–æ–∫ —Å–µ—Å—Å–∏–π |
| DELETE | `/admin/telegram/instances/{id}/sessions` | –û—á–∏—Å—Ç–∏—Ç—å —Å–µ—Å—Å–∏–∏ |
| GET | `/admin/telegram/instances/{id}/logs` | –ü–æ—Å–ª–µ–¥–Ω–∏–µ N —Å—Ç—Ä–æ–∫ –ª–æ–≥–∞ |
| GET | `/admin/telegram/instances/{id}/payments` | –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π |
| GET | `/admin/telegram/instances/{id}/payments/stats` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã—Ä—É—á–∫–∏ |

### –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET/POST/PUT/DELETE | `.../prompts` | –ê–≥–µ–Ω—Ç—Å–∫–∏–µ –ø—Ä–æ–º–ø—Ç—ã |
| GET/POST/PUT/DELETE | `.../quiz` | –ö–≤–∏–∑-–≤–æ–ø—Ä–æ—Å—ã |
| GET/POST/PUT/DELETE | `.../segments` | –°–µ–≥–º–µ–Ω—Ç—ã |
| GET/POST/PUT/DELETE | `.../followups` | Follow-up –ø—Ä–∞–≤–∏–ª–∞ |
| GET/POST/PUT/DELETE | `.../testimonials` | –û—Ç–∑—ã–≤—ã |

### YooMoney

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `.../yoomoney/auth-url` | URL –¥–ª—è OAuth |
| GET | `.../yoomoney/callback` | OAuth callback |
| GET | `.../yoomoney/status` | –°—Ç–∞—Ç—É—Å –∫–æ—à–µ–ª—å–∫–∞ |
| POST | `.../yoomoney/disconnect` | –û—Ç–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª—ë–∫ |

## RBAC

- **Admin** ‚Äî –≤–∏–¥–∏—Ç –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º–∏ –±–æ—Ç–∞–º–∏
- **User/Web** ‚Äî —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –±–æ—Ç—ã (`owner_id`)
- **Guest** ‚Äî —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ

---

‚Üê [[Widget]] | [[WhatsApp]] ‚Üí
