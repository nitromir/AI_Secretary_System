# Personas (Персоны секретаря)

Настройка встроенных персон (личностей) ИИ-секретаря, создание пользовательских промптов и управление стилем общения.

## Встроенные персоны

Система предоставляет две предустановленные персоны с различным стилем общения:

| Персона | Имя | Компания | Руководитель | Стиль общения |
|---------|-----|----------|--------------|---------------|
| **anna** | Анна | Shareware Digital | Артём Юрьевич | Дружелюбный, краткий |
| **marina** | Марина | Shareware Digital | Артём Юрьевич | Профессиональный |

## Характеристики персон

### Анна

**Полное описание:** Цифровой секретарь компании Shareware Digital и личный помощник Артёма Юрьевича.

**Правила общения:**
- Краткие ответы (2-3 предложения)
- Без разметки Markdown
- Использование буквы "ё"
- Числа прописью (не цифрами)
- ООО произносится как "о-о-о"
- IT произносится как "ай-ти"

**Роль:**
- Фильтрация спама и нежелательных продаж
- Запись сообщений для руководителя
- Профессиональное и дружелюбное общение

### Марина

**Полное описание:** Цифровой секретарь компании Shareware Digital и личный помощник Артёма Юрьевича.

**Роль:** Аналогична Анне, но с более формальным и профессиональным стилем общения.

## Конфигурация персон

### Уровни настройки

Персону можно выбрать на трёх уровнях приоритета:

| Уровень | Приоритет | Где настраивается |
|---------|-----------|-------------------|
| **Глобальный** | Низкий | ENV переменная `SECRETARY_PERSONA=anna` |
| **Инстанс бота** | Средний | Admin Panel → Telegram Bots → AI Settings |
| **Инстанс виджета** | Средний | Admin Panel → Chat Widgets → AI Settings |
| **Пользовательский промпт** | Высокий | Переопределяет дефолтные настройки персоны |

### Поля конфигурации

Каждая персона определяется следующими полями в словаре `SECRETARY_PERSONAS`:

```python
"anna": {
    "name": "Анна",
    "full_name": "Анна, цифровой секретарь компании Shareware Digital...",
    "company": "Shareware Digital",
    "boss": "Артём Юрьевич",
    "prompt": "Ты — Анна, цифровой секретарь компании Shareware Digital..."
}
```

## Добавление новой персоны

### Шаг 1: Редактирование кода

Откройте файл `vllm_llm_service.py` и добавьте новую запись в словарь `SECRETARY_PERSONAS`:

```python
"новая_персона": {
    "name": "Имя",
    "full_name": "Полное описание персоны",
    "company": "Название компании",
    "boss": "Имя руководителя",
    "prompt": "Системный промпт с инструкциями..."
}
```

### Шаг 2: Использование

После перезапуска orchestrator новая персона станет доступна:

- В переменной окружения: `SECRETARY_PERSONA=новая_персона`
- В настройках LLM (Admin Panel → Services → LLM)
- В настройках Telegram ботов (AI Settings)
- В настройках виджетов (AI Settings)

## Пользовательские промпты

### Переопределение персоны

Вы можете полностью переопределить системный промпт персоны:

1. Перейдите в Admin Panel → Services → LLM
2. Выберите персону из списка
3. Отредактируйте текст промпта
4. Нажмите "Сохранить"

Пользовательский промпт имеет наивысший приоритет и полностью заменяет дефолтное поведение персоны.

### Сброс к дефолту

Для возврата к исходному промпту нажмите кнопку "Сбросить" — система восстановит оригинальный текст из `SECRETARY_PERSONAS`.

## Использование в модулях

### Admin Panel

- **LLM Settings** (Services → LLM): выбор глобальной персоны
- **Telegram Bot AI Tab**: персона для конкретного бота
- **Widget AI Tab**: персона для конкретного виджета
- **GSM LLM Settings**: персона для телефонных звонков

### API

Персона передаётся через поле `persona` в запросах:

```bash
POST /chat
{
  "message": "Привет",
  "persona": "anna"
}
```

### ENV переменные

```bash
SECRETARY_PERSONA=anna  # или marina
```

---

← [[Wiki-RAG]] | [[API-Reference]] →
